{% extends "base.html" %}
{% block content %}

<div class="container mt-4">

  <!-- ================= DASHBOARD CARDS ================= -->
  <div class="row g-4 mb-4">

    <div class="col-md-4">
      <div class="card shadow border-0 text-center">
        <div class="card-body">
          <h6 class="text-muted">Total Jobs Posted</h6>
          <h2 class="fw-bold text-primary">{{ total_jobs }}</h2>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow border-0 text-center">
        <div class="card-body">
          <h6 class="text-muted">Total Applicants</h6>
          <h2 class="fw-bold text-success">{{ total_applicants }}</h2>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow border-0 text-center">
        <div class="card-body">
          <h6 class="text-muted">Pending Applications</h6>
          <h2 class="fw-bold text-warning">{{ total_pending }}</h2>
        </div>
      </div>
    </div>

  </div>

  <!-- ================= JOB LIST ================= -->
  <div class="card shadow border-0 mb-5">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">Your Posted Jobs</h5>
    </div>

    <div class="card-body p-0">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th>Job Title</th>
            <th>Location</th>
            <th>Salary</th>
            <th>Status</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>

        <tbody>
          {% for job in jobs %}
          <tr>
            <td>{{ job.job_title }}</td>
            <td>{{ job.location }}</td>
            <td>{{ job.salary|default:"Not Disclosed" }}</td>
            <td>
              {% if job.is_active %}
                <span class="badge bg-success">Active</span>
              {% else %}
                <span class="badge bg-secondary">Inactive</span>
              {% endif %}
            </td>
            <td class="text-center">
              <a href="{% url 'job_detail' job.id %}" class="btn btn-sm btn-outline-primary">View</a>
              <a href="{% url 'edit_job' job.id %}" class="btn btn-sm btn-outline-warning">Edit</a>
              <a href="{% url 'delete_job' job.id %}" class="btn btn-sm btn-outline-danger">Delete</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center py-4 text-muted">
              No jobs posted yet.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- ================= APPLICANTS TABLE ================= -->
  <div class="card shadow border-0">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">Job Applicants</h5>
    </div>

    <div class="card-body p-0">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th>Applicant Name</th>
            <th>Email</th>
            <th>Job Title</th>
            <th>Phone</th>
            <th>Status</th>
          </tr>
        </thead>

        <tbody>
          {% for applicant in job_applicants %}
          <tr>
            <td>{{ applicant.applicant.get_full_name }}</td>
            <td>{{ applicant.applicant.email }}</td>
            <td>{{ applicant.job.job_title }}</td>
            <td>{{ applicant.phone }}</td>
            <td>
              {% if applicant.status == "pending" %}
                <span class="badge bg-warning text-dark">{{ applicant.get_status_display }}</span>
              {% elif applicant.status == "accepted" %}
                <span class="badge bg-success">{{ applicant.get_status_display }}</span>
              {% elif applicant.status == "rejected" %}
                <span class="badge bg-danger">{{ applicant.get_status_display }}</span>
              {% endif %}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center py-4 text-muted">
              No applicants yet.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>

{% endblock %}
